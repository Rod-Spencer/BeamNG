using Microsoft.AspNetCore.Components;
using SpenSoft.DanBeamNG.Services;
using SpenSoft.BeamNG.VehicleObjects;

namespace SpenSoft.DanBeamNG.Pages.BodyStylePages
{
    public partial class Body_List : ComponentBase
    {
        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Constructors
        #endregion
        ////////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Parameters

        //[Parameter]
        //public String? ID { get; set; }

        #endregion Parameters
        ////////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Injections

        [Inject]
        public BodyStyleDataService_Interface? bodyStyleDataService { get; set; }

        #endregion Injections
        ////////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Private Properties

        //private Logger logger = Logger_Helper.GetCurrentLogger();

        #endregion Private Properties
        ////////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Public Properties

        public List<BodyStyles>? bodyStyleList { get; set; } = null;

        public BodyStyles? bodyStyle { get; set; }

        public int itemHeight { get; } = 50;

        #endregion Public Properties
        ////////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Screen State Properties

        protected String Message1 = String.Empty;
        protected String Message2 = String.Empty;
        protected String StatusClass = String.Empty;
        protected Boolean Error = false;

        #endregion Screen State Properties
        ////////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Override Methods

        protected override async Task OnInitializedAsync()
        {
            Error = false;
            try
            {
                bodyStyleList = null;
                bodyStyleList = (await bodyStyleDataService.GetAllBodyStyle()).OrderBy(x => x.Name).ToList();
            }
            catch (Exception ex)
            {
                //logger.Error(Exception_Helper.FormatExceptionString(ex));
                StatusClass = "alert-danger"; Message1 = $"The following Exception error was thrown while trying to retrieve the image list: {ex.Message}";
                Message2 = "Please see runtime log for more details";
                Error = true;
            }
        }

        #endregion Override Methods
        ////////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Protected Methods
        #endregion
        ////////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Public Methods

        public async Task Delete_Body_Handler(BodyStyles bodyStyle)
        {
            if (bodyStyleDataService != null)
            {
                await bodyStyleDataService.DeleteBodyStyle(bodyStyle.ID);
                //bodyStyleList?.Remove(bodyStyle);
                var bsList = bodyStyleDataService.GetAllBodyStyle();
                if ( bsList!= null)
                bodyStyleList = bsList?.Result?.OrderBy(x => x.Name).ToList();
            }
            await Task.CompletedTask;
        }


        #endregion
        ////////////////////////////////////////////////////////////////////////////////////////////////////


        ////////////////////////////////////////////////////////////////////////////////////////////////////
        #region Private Methods
        #endregion
        ////////////////////////////////////////////////////////////////////////////////////////////////////
    }
}
